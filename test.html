function generateCode() {
    // 1. Début du document HTML et styles CSS pour le rendu final
    let html = `<!DOCTYPE html><html><head><meta charset="utf-8"><style>
            body { font-family: sans-serif; background: #222; margin:0; display:flex; justify-content:center; align-items:center; height:100vh; }
            .slide { display: none; width: 800px; height: 450px; background: white; position: relative; overflow:hidden; box-shadow: 0 0 50px black; }
            .slide.active { display: block; }
            .element { position: absolute; white-space: nowrap; }
            /* Style des boutons de navigation générés */
            .gen-btn {
                display:flex; align-items:center; justify-content:center;
                background:#27ae60; color:white; border:none; cursor:pointer;
                border-radius:5px; box-shadow: 2px 2px 5px rgba(0,0,0,0.3);
                text-decoration: none; font-size: 14px;
            }
            .gen-btn:hover { background:#2ecc71; transform:translateY(-1px); }
</style></head><body>`;
 
    // 2. Boucle sur chaque slide pour générer le contenu
    slidesData.forEach((slide, idx) => {
        const isActive = idx === 0 ? 'active' : ''; // Seule la première slide est visible au départ
        html += `<div id="${slide.id}" class="slide ${isActive}">`;
 
        slide.elements.forEach(el => {
            if (el.type === 'text') {
                html += `<div class="element" style="left:${el.x}px; top:${el.y}px;
                             font-size:${el.fontSize}px; font-weight:${el.bold?'bold':'normal'};
                             font-style:${el.italic?'italic':'normal'}; color:${el.color};">
                             ${el.content}</div>`;
            } else if (el.type === 'image') {
                html += `<img class="element" src="${el.src}" style="left:${el.x}px; top:${el.y}px; width:${el.width}px;">`;
            } else if (el.type === 'linkButton') {
                // Génération du bouton interactif qui appelle la fonction go()
                html += `<button class="element gen-btn" onclick="go('${el.targetId}')"
                             style="left:${el.x}px; top:${el.y}px; width:${el.width}px; height:${el.height}px; font-size:${el.fontSize}px;">
                             ${el.content}</button>`;
            }
        });
        html += `</div>`;
    });
 
    // 3. Script JS interne au fichier final pour gérer le changement de slide
    html += `<script>
            function go(id) {
                document.querySelectorAll('.slide').forEach(s => s.classList.remove('active'));
                document.getElementById(id).classList.add('active');
            }
<\/script></body></html>`;
 
    // 4. Création du Blob et déclenchement du téléchargement
    const blob = new Blob([html], {type: 'text/html'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'Projet_V6.html'; // Nom du fichier final
    a.click();
}