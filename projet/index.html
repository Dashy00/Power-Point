<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>√âditeur Graphique Modulaire</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
 
    <div class="editor-wrapper" id="graph-interface">
       
        <div class="sidebar">
            <div class="sidebar-header">
               <img src="images/newlogo.png" alt="NodeFlow" class="sidebar-logo" style="height: 50px; margin: auto; display: block; mix-blend-mode: multiply;">
            </div>
           
            <div class="sidebar-item" id="btn-new-slide">
                <img src="images/add_diapo.png" class="icon" alt="+">
                <span class="label">Nouvelle<br>diapositive</span>
            </div>
           
            <div class="sidebar-item" id="btn-condition">
                <img src="images/condition.png" class="icon" alt="Condition">
                <span class="label">Condition</span>
            </div>
           
            <div class="sidebar-item" id="btn-bloc-fin">
                <img src="images/add_end.png" class="icon" alt="Fin">
                <span class="label">Bloc Fin</span>
            </div>
 
            <div class="sidebar-item set-start" id="btn-set-start">
                <span class="icon-text">üè¥</span>
                <span class="label">D√©finir comme<br>D√©but</span>
            </div>
           
            <div class="sidebar-spacer"></div>
 
            <div class="sidebar-item load" id="btn-load">
                <img src = "images/charger.png" class="icon" alt="Charger Projet">
                <span class="label">Charger Projet</span>
            </div>
            <input type="file" id="file-upload" accept=".html" style="display: none;">
           
            <button id="btn-delete" class="sidebar-item delete">
                <img src="images/logo_poubelle.png" class="icon" alt="Supprimer">
                <span class="label">Supprimer</span>
            </button>
           
            <button id="btn-play" class="sidebar-item play">
                <img src = "images/logo_play.png" class="icon" alt="Afficher">
                <span class="label">Afficher</span>
            </button>
 
            <button id="btn-generate" class="sidebar-item export">
                <img src="images/logo_telecharger.png" class="icon" alt="G√©n√©rer">
                <span class="label">G√©n√©rer</span>
            </button>
        </div>
 
        <div class="main-content">
            <div class="viewport" id="viewport">
                <div class="canvas" id="canvas">
                    <svg id="connections-layer">
                        <defs>
                            <marker id="arrow-end" markerWidth="10" markerHeight="10" refX="10" refY="5" orient="auto">
                                <path d="M0,0 L10,5 L0,10" fill="#2c3e50" />
                            </marker>
                            <marker id="arrow-start" markerWidth="10" markerHeight="10" refX="0" refY="5" orient="auto">
                                <path d="M10,0 L0,5 L10,10" fill="#2c3e50" />
                            </marker>
                        </defs>
                    </svg>
                </div>
            </div>
 
            <div class="zoom-controls">
                <button id="btn-zoom-out" class="zoom-btn">‚àí</button>
                <span id="zoom-text">100 %</span>
                <button id="btn-zoom-in" class="zoom-btn">+</button>
                <button id="btn-reset" class="reset-btn">‚ü≤</button>
            </div>
        </div>
    </div>
 
    <div id="editor-overlay" class="editor-overlay" style="display: none;">
        <div class="overlay-header">
            <button id="btn-close-editor" class="back-btn">‚Üê Retour au Graphe</button>
           
            <div class="toolbar-group">
                <label style="color: #4e342e; font-size: 12px; margin-right: 5px;">N¬∞</label>
                <input type="text" id="slideNumber" placeholder="1" title="Num√©ro de la diapositive" style="width: 60px; padding: 4px 8px; border-radius: 4px; border: 1px solid #dcd7c9; background: #fdfbf7; color: #4e342e; font-size: 14px;">
            </div>
            <div class="toolbar-group" style="border-right: none;">
                <button class="top-tool-btn" id="undoBtn" title="Annuler (Ctrl+Z)">‚Ü©</button>
                <button class="top-tool-btn" id="redoBtn" title="R√©tablir (Ctrl+Y)">‚Ü™</button>
                <button class="top-tool-btn" id="bringToFrontBtn" title="Amener au premier plan">‚¨ÜÔ∏é</button>
                <button class="top-tool-btn" id="sendToBackBtn" title="Envoyer au dernier plan">‚¨áÔ∏é</button>
            </div>
            <div>
                <img src="images/newlogo.png" alt="NodeFlow" class="sidebar-logo" style="height: 50px; margin: 150%; display: block; mix-blend-mode: multiply;">
            </div>
            <div class="zoom-controls-editor">
                <button class="zoom-btn" onclick="zoomOut()" title="D√©zoomer">‚àí</button>
                <span id="editor-zoom-text">100%</span>
                <button class="zoom-btn" onclick="zoomIn()" title="Zoomer">+</button>
                <button class="reset-btn" onclick="resetZoom()" title="R√©initialiser">‚ü≤</button>
            </div>
        </div>
 
        <div class="overlay-body" style="position: relative;">
            
            <svg id="editor-lines-layer"></svg>

            <div class="overlay-sidebar">
                <h4>Ajouter</h4>
                <button class="overlay-btn" id="addTextBtn">Texte</button>
                <button class="overlay-btn" id="addImageBtn">Image</button>
                <button class="overlay-btn" id="addBubbleBtn">Bulle</button>
                <input type="file" id="imageInput" hidden accept="image/*">
               
                <hr style="margin: 10px 0; border: 0; border-top: 1px solid #dcd7c9;">
               
                <h4>Formes</h4>
                <div class="shape-grid">
                    <button class="overlay-btn shape-btn" onclick="addEditorShape('square')" title="Carr√©">‚ñ¢</button>
                    <button class="overlay-btn shape-btn" onclick="addEditorShape('circle')" title="Cercle">‚óã</button>
                    <button class="overlay-btn shape-btn" onclick="addEditorShape('triangle')" title="Triangle">‚ñ≥</button>
                    <button class="overlay-btn shape-btn" onclick="addEditorShape('arrow')" title="Fl√®che">‚ûî</button>
                </div>
                <label style="font-size: 12px; display: block; margin-top: 10px;">Couleur :</label>
                <input type="color" id="shapeColorPicker" value="#8d6e63" style="width: 100%; cursor: pointer; height: 35px;">

                <label style="font-size: 12px; display: block; margin-top: 10px;">Opacit√© :</label>
                <input type="range" id="opacityPicker" min="0" max="1" step="0.1" value="1" style="width: 100%; cursor: pointer;">
                <hr style="margin: 10px 0; border: 0; border-top: 1px solid #dcd7c9;">
               
                <h4>Arri√®re-plan</h4>
                <label style="font-size: 12px">Couleur de fond :</label>
                <input type="color" id="bgColorPicker" value="#ffffff" style="width: 100%; cursor: pointer;">
                <button class="overlay-btn" id="bgImageBtn" style="margin-top:5px; font-size:12px;">Image de fond</button>
                <input type="file" id="bgImageInput" hidden accept="image/*">
            </div>
 
            <div class="overlay-workspace">
                <div class="slide-zoom-wrapper" id="slideZoomWrapper">
                    <div id="editable-slide" class="overlay-slide"></div>
                </div>
               
                <div class="floating-toolbar" id="floatingToolbar">
                    <select id="fontFamily" title="Police">
                        <option value="Arial">Arial</option>
                        <option value="Times New Roman">Times New Roman</option>
                        <option value="Georgia">Georgia</option>
                        <option value="Verdana">Verdana</option>
                        <option value="Courier New">Courier New</option>
                    </select>
                    <select id="fontSize" title="Taille">
                        <option value="12px">12</option>
                        <option value="16px">16</option>
                        <option value="18px" selected>18</option>
                        <option value="24px">24</option>
                        <option value="32px">32</option>
                        <option value="48px">48</option>
                        <option value="64px">64</option>
                        <option value="72px">72</option>
                        <option value="96px">96</option>
                    </select>
                    <input type="color" id="textColor" value="#333333" title="Couleur du texte">
                    <div class="toolbar-separator"></div>
                    <button class="tool-btn" id="boldBtn" title="Gras"><b>G</b></button>
                    <button class="tool-btn" id="italicBtn" title="Italique"><i>I</i></button>
                    <button class="tool-btn" id="underlineBtn" title="Soulign√©"><u>S</u></button>
                    <div class="toolbar-separator"></div>
                    <input type="color" id="highlightColor" value="#ffff00" title="Couleur de surlignage">
                    <button class="tool-btn" id="highlightBtn" title="Surligner">üñçÔ∏è</button>
                </div>
            </div>

            <div class="overlay-sidebar right-sidebar" id="linkedSlidesPanel">
                </div>
        </div>
    </div>
   
    <div id="condition-overlay" class="editor-overlay" style="display: none; align-items: center; justify-content: center; background: rgba(62, 39, 35, 0.6);">
        <div class="condition-modal" style="width: 500px; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 10px 25px rgba(93, 64, 55, 0.4); font-family: 'Segoe UI', sans-serif;">
            
            <div style="background: #8d6e63; padding: 15px; text-align: center; border-bottom: 3px solid #5d4037;">
                <h2 style="color:#fffdfd; margin: 0; font-weight: normal; letter-spacing: 1px;">Configuration Condition</h2>
            </div>

            <div style="padding: 20px; background:#fdfbf7;">
                
                <div style="margin-bottom: 20px;">
                    <h4 style="color: #000000; margin-bottom: 10px; border-bottom: 1px solid #5d6d7e; padding-bottom: 5px;">1. Diapositives √† visiter</h4>
                    <div id="condition-list" style="max-height: 150px; overflow-y: auto; background: #dfcac3; padding: 5px; border-radius: 4px; border: 1px solid #5d6d7e;">
                        </div>
                </div>

                <div style="margin-bottom: 20px;">
                    <h4 style="color: #000000; margin-bottom: 10px; border-bottom: 1px solid #5d6d7e; padding-bottom: 5px;">2. Temps minimum requis</h4>
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <select id="time-slide-select" style="flex: 1; padding: 8px; border-radius: 4px; border: none;">
                            <option value="">-- Aucune contrainte de temps --</option>
                        </select>
                        <input type="number" id="time-duration-input" placeholder="Sec." min="0" style="width: 70px; padding: 8px; border-radius: 4px; border: none;">
                        <span style="color: white;">secondes</span>
                    </div>
                </div>

                <div>
                    <h4 style="color: #000000; margin-bottom: 10px; border-bottom: 1px solid #5d6d7e; padding-bottom: 5px;">3. Options sp√©ciales</h4>
                    <div style="display: flex; align-items: center; gap: 10px;">
                        <input type="checkbox" id="chk-one-time" style="width: 20px; height: 20px; cursor: pointer;">
                        <label for="chk-one-time" style="color: rgb(0, 0, 0); cursor: pointer;">Passage unique (le bouton dispara√Æt apr√®s usage)</label>
                    </div>
                </div>

                <div style="display: flex; justify-content: space-between; margin-top: 25px;">
                    <button id="btn-cancel-condition" style="background: #8f8181; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-weight: bold;">
                        Annuler
                    </button>
                    <button id="btn-save-condition" style="background: #6D4C41; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-weight: bold;">
                        Sauvegarder
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div id="presentation-overlay" class="player-overlay" style="display: none;">
        <button id="btn-close-player" class="player-close-btn">Quitter ‚úï</button>
        <div id="player-stage" class="player-stage"></div>
    </div>
 
    <script src="globals.js"></script>
    <script src="editor.js"></script>
    <script src="app.js"></script>
</body>
</html>